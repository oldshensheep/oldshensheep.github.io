<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Notes | oldshensheep</title><meta name=keywords content><meta name=description content="Notes - oldshensheep"><meta name=author content="oldshensheep"><link rel=canonical href=https://blog.oldshensheep.com/note/><link crossorigin=anonymous href=/assets/css/stylesheet.min.ec8da366ca2fb647537ccb7a8f6fa5b4e9cd3c7a0d3171dd2d3baad1e49c8bfc.css integrity="sha256-7I2jZsovtkdTfMt6j2+ltOnNPHoNMXHdLTuq0eSci/w=" rel="preload stylesheet" as=style><link rel=icon href=https://blog.oldshensheep.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://blog.oldshensheep.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://blog.oldshensheep.com/favicon-32x32.png><link rel=apple-touch-icon href=https://blog.oldshensheep.com/apple-touch-icon.png><link rel=mask-icon href=https://blog.oldshensheep.com/apple-touch-icon.png><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate type=application/rss+xml href=https://blog.oldshensheep.com/note/index.xml><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--hljs-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="Notes"><meta property="og:description" content="oldshensheep"><meta property="og:type" content="website"><meta property="og:url" content="https://blog.oldshensheep.com/note/"><meta property="og:image" content="https://blog.oldshensheep.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta property="og:site_name" content="oldshensheep"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://blog.oldshensheep.com/%3Clink%20or%20path%20of%20image%20for%20opengraph,%20twitter-cards%3E"><meta name=twitter:title content="Notes"><meta name=twitter:description content="oldshensheep"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Notes","item":"https://blog.oldshensheep.com/note/"}]}</script></head><body class=list id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://blog.oldshensheep.com/ accesskey=h title="Home (Alt + H)"><img src=https://blog.oldshensheep.com/apple-touch-icon.png alt=logo aria-label=logo height=35>Home</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu><li><a href=https://blog.oldshensheep.com/categories/ title=categories><span>categories</span></a></li><li><a href=https://blog.oldshensheep.com/tags/ title=tags><span>tags</span></a></li><li><a href=https://oldshensheep.github.io/toyweb/ title=toys><span>toys</span></a></li></ul></nav></header><main class=main><header class=page-header><div class=breadcrumbs><a href=https://blog.oldshensheep.com/>Home</a></div><h1>Notes
<a href=index.xml title=RSS aria-label=RSS><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" height="23"><path d="M4 11a9 9 0 019 9"/><path d="M4 4a16 16 0 0116 16"/><circle cx="5" cy="19" r="1"/></svg></a></h1></header><article class=post-entry><header class=entry-header><h2>Windows 快照？</h2></header><div class=entry-content><p>Windows 也有快照？真的是文件系统的快照？还可以通过系统自带的文件历史还原？
新建快照 Windows 称之为 Volume Shadow Copy (VSS)
Windows 的快照是通过 Copy On Write 实现的，众所周知对性能有一定影响。
关闭系统还原点功能 新建快照是不需要开启系统还原点功能的！
开启还原点功能会导致老的快照更快的被删除，因为快照占用的空间是有限的，而还原点会占用大量的快照空间，快照空间不足就会删除旧的快照，所以最好把还原点功能关闭了。
新建一个快照 新建一个文件测试一下快照
在 HOME 目录下新建一个内容为 100 的 test.txt 文件
❯ 100 > test.txt ❯ cat .\test.txt 100 创建一个 C 盘的快照，注意我这里用了 sudo 表明需要管理员权限。
❯ sudo wmic shadowcopy call create Volume=C:\ Executing (Win32_ShadowCopy)->create() Method execution successful. Out Parameters: instance of __PARAMETERS { ReturnValue = 0; ShadowID = "{57587129-D224-4E21-BC36-4C3D9B1DFDC7}"; }; 快照就成功建立了！
看看效果是怎么样的，把之前新建得到 ~/test.txt 的内容修改为 101 试试。...</p></div><footer class=entry-footer><span title='2022-08-09 20:00:00 +0000 UTC'>August 9, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;239 words&nbsp;·&nbsp;oldshensheep</footer><a class=entry-link aria-label="post link to Windows 快照？" href=https://blog.oldshensheep.com/note/windows-snapshot/></a></article><article class=post-entry><header class=entry-header><h2>ZFS on Windows (using WSL2)</h2></header><div class=entry-content><p>这个让 ZFS 工作在 Windows 上的项目还不太稳定，经常蓝屏，便寻求其他解决方案，于是乎。
有人可能会说你在不是脱裤子放屁吗，这不就是装个虚拟机运行 Linux？？？
是的，我就是脱裤子放屁。
写这个文章的时候使用的是 ArchLinux 的 WSL2，为了使教程更简单，也为了从 0 实现，这篇文章使用 Ubuntu22.04 版本进行测试。
先决条件 安装 WSL2 版本的 Ubuntu22.04，其他的系统版本应当也可。
具体安装方法参考官方文档。
对于系统版本大于 Windows 10 version 2004 或者 Windows11 的用户参考下面的文档：
https://docs.microsoft.com/en-us/windows/wsl/install
对于系统版本大于 Version 1903 的参考下面的文档：
https://docs.microsoft.com/en-us/windows/wsl/install-manual
替换 WSL 的 Linux Kernel 参考文档1
在此 https://github.com/oldshensheep/zfs-on-wsl/releases 下载编译好的支持 ZFS 的 Kernel，需要下载 bzImage，放到 Windows 的一个地方。
然后在 PowerShell 窗口中执行以下命令：
注意把&lt;bzImage Path>替换成你下载的 bzImage 的路径，例如C:\\Fun\\bzImage
" [wsl2] kernel=&lt;bzImage Path> " > ~/.wslconfig 然后wsl --shutdown关闭运行中的实例，然后重新启动 Ubuntu。
挂载硬盘到 WSL2 参考文档2...</p></div><footer class=entry-footer><span title='2022-07-27 18:30:00 +0000 UTC'>July 27, 2022</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;412 words&nbsp;·&nbsp;oldshensheep</footer><a class=entry-link aria-label="post link to ZFS on Windows (using WSL2)" href=https://blog.oldshensheep.com/note/zfs-on-windows/></a></article><article class=post-entry><header class=entry-header><h2>让 Windows 更加适合开发</h2></header><div class=entry-content><p>在 Windows 上进行优雅的编程是个头疼的问题，但是在我的精心调教下，她变得听话了许多……
安装 scoop 为什么选择 scoop？
有类似的选择如 chocolatey ，WinGet 但是我选择了 scoop。第一是因为 scoop 的软件很多是便携软件。便携，顾名思义可以很方便带着跑的东西。scoop 安装的软件也是一样的，重装系统不必重新配置一大堆环境变量，不必重新安装一大堆软件。重装系统后可以很快就可以配置好各种环境变量，软件也不必再安装。
安装 scoop 也非常简单
Set-ExecutionPolicy RemoteSigned -Scope CurrentUser irm get.scoop.sh | iex 有更多问题访问 scoop 官网 https://scoop.sh/
报告问题等访问仓库 Issue https://github.com/ScoopInstaller/Scoop/issues
变成Lindows 安装了 scoop，是时候展现她的力量了。
先来安装一下 busybox 和 gsudo
scoop install busybox gsudo busybox 内置了 linux 的很多命令，常用的基本上都有了。
安装 gsudo 可以临时提权类似与 linux 的 sudo（不过有烦人的 UAC，关掉又不安全）。Windows 最终变成了 Linux 的样子，嘿嘿 Windows❤️Linux。
安装完成后可以使用sudo命令提权
🔽点击展开 Windows中busybox自带的命令 ar arch ash awk base64 basename bash bunzip2 bzcat bzip2 cal cat chmod cksum clear cmp comm cp cpio cut date dc dd df diff dirname dos2unix dpkg dpkg-deb du echo ed egrep env expand expr factor false fgrep find fold fsync ftpget ftpput getopt grep groups gunzip gzip hd head hexdump httpd iconv id ipcalc kill killall less link ln logname ls lzcat lzma lzop lzopcat man md5sum mkdir mktemp mv nc nl od paste patch pgrep pidof pipe_progress pkill printenv printf ps pwd readlink realpath reset rev rm rmdir rpm rpm2cpio sed seq sh sha1sum sha256sum sha3sum sha512sum shred shuf sleep sort split ssl_client stat strings su sum tac tail tar tee test time timeout touch tr true truncate ts ttysize uname uncompress unexpand uniq unix2dos unlink unlzma unlzop unxz unzip usleep uudecode uuencode vi watch wc wget which whoami whois xargs xxd xz xzcat yes zcat 有了这些命令Windows变得更像Linux了。如果有没有的命令可以尝试搜索一下`scoop search something`。 开发环境配置 在 Linux 里配置开发环境是很简单的，例如在 ArchLinux 里配置 java 开发环境，很快捷方便。...</p></div><footer class=entry-footer><span title='2022-05-27 20:00:00 +0000 UTC'>May 27, 2022</span>&nbsp;·&nbsp;3 min&nbsp;·&nbsp;464 words&nbsp;·&nbsp;oldshensheep</footer><a class=entry-link aria-label="post link to 让 Windows 更加适合开发" href=https://blog.oldshensheep.com/note/lindows/></a></article><article class=post-entry><header class=entry-header><h2>Private Network Access update</h2></header><div class=entry-content><p>在你访问一个 http 网站时你可能遇到了下面的错误。
The request client is not a secure context and the resource is in more-private address space local 这是 Chrome94 之后的版本提供的错误提示，因为你的浏览器从 一个源为 http 的网站访问了一个 私有地址 (不太准确)。这在 Chrome 之后默认是不允许的。1
Why? 为什么不允许？当前的浏览器都不限制 http 网站访问私有地址，这是一个安全隐患。
假设你有一个路由器，用户名密码都是默认的，然后访问了一个 http 的网站，那个网站是可以访问到路由器的，而你的路由器的用户名密码又是默认的，那么网站就可以登录到你的路由器了。
还有就是我们一般认为外界是访问不了本地网络的服务的，这样我们可能都设个弱口令。但是通过浏览器，网站就可以访问到本地网络，我们的本地服务就有被攻击的风险。
What? 什么情况下请求会被认为是Private Network Access？
网络地址分为 3 类（不讨论 IPv6）。详细资料可以从2获取
Local 127.0.0.0/8 Private 10.0.0.0/8 172.16.0.0/12 192.168.0.0/16 169.254.0.0/16 Public 上面列出的之外的 ip 从上到下越来越开放，
一个源为 http 的请求的地址比目的地址更开放，那么这个请求就是私有网络访问。不外乎 3 种情况，Public->Private，Public->Local，Private->Local。 另一个比较特殊的是用代理会改变目的地址的 ip，通过代理获取的资源，被看作是从代理的 ip 那里获取的。（这里说的改变不是真的改变） How? 怎么解决当前的问题？下面的内容参考自1。
访问 Local 把你要访问的网站升级到 https。...</p></div><footer class=entry-footer><span title='2021-09-27 15:50:00 +0000 UTC'>September 27, 2021</span>&nbsp;·&nbsp;1 min&nbsp;·&nbsp;101 words&nbsp;·&nbsp;oldshensheep</footer><a class=entry-link aria-label="post link to Private Network Access update" href=https://blog.oldshensheep.com/note/private-network-access-update/></a></article><article class=post-entry><header class=entry-header><h2>Pointers in C/C++</h2></header><div class=entry-content><p>C/C++ 的指针是什么？int* ? *(int*)var? 是什么鬼？？？
指针就是地址，与其说指针，地址更容易理解。
指针变量的定义 一般的定义一个指针变量：数据类型* 变量名= new 数据类型();
int* i = new int(1); Sheep* sheep = new Sheep("mmm"); 一个指针变量是有类型的（这不是废话？）为什么要有类型？地址大小不都是一样的吗？一般是32位或64位啊。
但是如果指针变量没有类型的话用*运算符怎么取值？是取32位还是64位还是其他的？所以定义指针变量时声明的变量类型就是这个道理。
如果你学过了汇编，下面的例子可以帮助你理解，看例子1，这里将2020h移入一个内存空间，为什么要加word ptr? 2020h不就是2个字节吗，你再声明写入一个2字节的内存空间不是有点多余？这里看起来有点多余，但是如果有这样的汇编指令（例子2和3），他们的行为一样吗？
实际上是不一样的mov word ptr [addr],20h可以理解为mov word ptr [addr],0020h是实际上写入了2个字节的数据，例子3只写入了一个字节。再看例子4，如果不加word ptr你怎么区分例子2和例子3？（就是说你不知道你要写入多少数据）
mov word ptr [addr],2020h ;例子1 mov word ptr [addr],20h ;例子2 mov byte ptr [addr],20h ;例子3 mov [addr],20h ;例子4 mov ax,[addr] ;例子5 可以运行、修改下面的汇编代码测试上面的说法。
DATA SEGMENT num dd 660F0655H DATA ENDS CODE SEGMENT ASSUME CS:CODE,DS:DATA START: mov ax,data mov ds,ax lea si,num mov word ptr [si],2020h mov ah,4ch int 21h CODE ENDS END START 指针的具体使用 代码 #include &lt;iostream> using namespace std; int main() { int* i = new int(1); int* j = new int(2); int k = 0; int l = 0x64fe10; // 或者 &amp;j /** * l为j变量的地址，理论上**l就可以取j的值 *l取j的内存地址，再取值。 * 实际上因为int类型不能直接取值，要转换成对应的数据类型的指针，再取值。 * 即*(int*)(*(int*)l) */ cout &lt;&lt; "变量的内存地址" &lt;&lt; endl; cout &lt;&lt; "&amp;i: " &lt;&lt; &amp;i &lt;&lt; endl; cout &lt;&lt; "&amp;j: " &lt;&lt; &amp;j &lt;&lt; endl; cout &lt;&lt; "&amp;k: " &lt;&lt; &amp;k &lt;&lt; endl; cout &lt;&lt; "&amp;l: " &lt;&lt; &amp;l &lt;&lt; endl &lt;&lt; endl; cout &lt;&lt; "变量的值" &lt;&lt; endl; cout &lt;&lt; "i: " &lt;&lt; i &lt;&lt; endl; cout &lt;&lt; "j: " &lt;&lt; j &lt;&lt; endl; cout &lt;&lt; "k: " &lt;&lt; k &lt;&lt; endl; cout &lt;&lt; "l: " &lt;&lt; l &lt;&lt; endl &lt;&lt; endl; cout &lt;&lt; *i &lt;&lt; endl; cout &lt;&lt; "l的值转成\"int*\"类型后取值" &lt;&lt; endl; cout &lt;&lt; *(int*)l &lt;&lt; "\thex: " &lt;&lt; (int*)(*(int*)l) &lt;&lt; endl; cout &lt;&lt; "l的值指向的地址的值，再取前面的值指向的地址的值:" &lt;&lt; *(int*)(*(int*)l) &lt;&lt; endl &lt;&lt; endl; return 0; } 运行结果 变量的内存地址 &amp;i: 0x64fe18 &amp;j: 0x64fe10 &amp;k: 0x64fe0c &amp;l: 0x64fe08 变量的值 i: 0x2632540 j: 0x2632560 k: 0 l: 6618640 1 l的值转成"int*"类型后取值 40052064 hex: 0x2632560 l的值指向的地址的值，再取前面的值指向的地址的值:2 变量的内存分布 地址的值可能有所不同...</p></div><footer class=entry-footer><span title='2021-06-14 14:42:56 +0000 UTC'>June 14, 2021</span>&nbsp;·&nbsp;2 min&nbsp;·&nbsp;311 words&nbsp;·&nbsp;oldshensheep</footer><a class=entry-link aria-label="post link to Pointers in C/C++" href=https://blog.oldshensheep.com/note/c++-pointer/></a></article><footer class=page-footer><nav class=pagination><a class=next href=https://blog.oldshensheep.com/note/page/2/>Next »</a></nav></footer></main><footer class=footer><span>&copy; 2023 <a href=https://blog.oldshensheep.com/>oldshensheep</a></span>
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
        <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>